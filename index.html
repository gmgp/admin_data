<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>admin_data guide</title>

<link rel="stylesheet" type="text/css" href="files/stylesheets/style.css" />
<link rel="stylesheet" type="text/css" href="files/stylesheets/syntax.css" />
<link rel="stylesheet" type="text/css" href="files/stylesheets/print.css" media="print" />

<script type="text/javascript" src="files/javascripts/guides.js"></script>
<script type="text/javascript" src="files/javascripts/code_highlighter.js"></script>
<script type="text/javascript" src="files/javascripts/highlighters.js"></script>

</head>
<body class="guide">
  <div id="topNav">
      <h1>
        <a href="index.html">admin_data guide</a>
      </h1>
  </div>
  </div>

  <div id="feature">
    <div class="wrapper">
      <h2></h2>

<ul>
	<li>Live demo is available at <a href="http://demo.neeraj.name/admin_data">http://demo.neeraj.name/admin_data</a></li>
</ul>

            <div id="subCol">
        <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />Chapters</h3>
        <ol class="chapters">
<li><a href="#whatisadmin-data">What is admin_data?</a><ul><li><a href="#source-code">Source Code</a></li><li><a href="#live-demo">Live Demo</a></li><li><a href="#bug-reporting">Bug Reporting</a></li><li><a href="#railsversionsupported">Rails version supported</a></li><li><a href="#isit-rails3compatible">Is it Rails3 compatible ?</a></li><li><a href="#databasethataresupported">Database that are supported</a></li><li><a href="#requirement">Requirement</a></li></ul></li><li><a href="#features">Features</a><ul><li><a href="#non-intrusive">Non Intrusive</a></li><li><a href="#browsingand-searching">Browsing and Searching</a></li><li><a href="#association-information">Association Information</a></li><li><a href="#miscellaneousfeatures">Miscellaneous features</a></li></ul></li><li><a href="#installing">Installing</a><ul></ul></li><li><a href="#configuringtheplugin">Configuring the plugin</a><ul><li><a href="#numberofrecordsperpage">Number of records per page</a></li><li><a href="#localjqueryfileinsteadofgooglehostedversion">local jquery file instead of google hosted version</a></li><li><a href="#ignorecolumnlimit">Ignore column limit</a></li><li><a href="#overridethedefaultfindcondition">Override the default find condition</a></li><li><a href="#overridethedefaultbehaviourofcolumn">Override the default behaviour of column</a></li><li><a href="#replacedropdownassociationswithinputtext">Replace drop down associations with input text</a></li><li><a href="#rs-sfeedforallmodels"><span class="caps">RSS</span> feed for all models</a></li><li><a href="#customorderofcolumnsinlisting">Custom order of columns in listing</a></li></ul></li><li><a href="#security-configurations">Security Configurations</a><ul></ul></li><li><a href="#howtousethispluginwithrails3">How to use this plugin with rails3</a><ul></ul></li><li><a href="#howtoruntestforthisplugin">How to run test for this plugin</a><ul></ul></li><li><a href="#authorand-contributors">Author and Contributors</a><ul></ul></li></ol></div>
    </div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <h3 id="whatisadmin-data">1 What is admin_data?</h3>
<p><tt>admin_data</tt> is a Rails plugin which allows to easily browse, search and manage data using browser.</p>
<h4 id="source-code">1.1 Source Code</h4>
<p>Source code is available at <a href="http://github.com/neerajdotname/admin_data">http://github.com/neerajdotname/admin_data</a> .</p>
<h4 id="live-demo">1.2 Live Demo</h4>
<p>Live demo of the application is available at <a href="http://demo.neeraj.name/admin_data">http://demo.neeraj.name/admin_data</a> . While viewing the demo you are not logged in as admin and hence you will not be able to edit, delete, destroy or create any new record.</p>
<h4 id="bug-reporting">1.3 Bug Reporting</h4>
<p>Please report all bugs at <a href="http://github.com/neerajdotname/admin_data/issues">http://github.com/neerajdotname/admin_data/issues</a> .</p>
<h4 id="railsversionsupported">1.4 Rails version supported</h4>
<p>This plugin supports rails 2.3.5 and higher. Some people have posted that it works with lower versions of rails but I have not tested that.</p>
<h4 id="isit-rails3compatible">1.5 Is it Rails3 compatible ?</h4>
<p>Not yet. But that should change by the middle of July 2010.</p>
<h4 id="databasethataresupported">1.6 Database that are supported</h4>
<p>I have tested this plugin with MySQL, PostgreSQL and Oracle.</p>
<h4 id="requirement">1.7 Requirement</h4>
<ul>
	<li>Rails 2.3.5+</li>
	<li>will_paginate gem</li>
</ul>
<h3 id="features">2 Features</h3>
<h4 id="non-intrusive">2.1 Non Intrusive</h4>
<p>All the features provided by <tt>admin_data</tt> are totally non intrusive. No change is required anywhere in your application. No named_scope is created and hence no lingering named_scope in your application. Nothing is stored in session or in cookies. No file is put in your <tt>public</tt> folder or anywhere else. No table is created. No migration to run. It is totally non intrusive.</p>
<h4 id="browsingand-searching">2.2 Browsing and Searching</h4>
<ul>
	<li>Browse all records with pagination .</li>
	<li>Quick search across all records in a table. Quick searche goes through all columns that are either <tt>string</tt> or <tt>text</tt> type.</li>
	<li>Advance search for each field of each of the tables. Different options appear for diffent data types. <a href="http://demo.neeraj.name/admin_data/advance_search/user">Click here</a> to see advance search in action. Do try selecting different data types to see different options.</li>
	<li>For both quick search and advance search, result can be sorted in ascending or in descending order of any column.</li>
	<li>Browse <a href="http://demo.neeraj.name/admin_data/migration">migration records</a> from schema_migrations table even though there is no corresponding model for this table.</li>
</ul>
<h4 id="association-information">2.3 Association Information</h4>
<ul>
	<li>For each individual record a snapshot of all associated records is shown. <a href="http://demo.neeraj.name/admin_data/klass/user/501-stefanie-blick">Click here</a> to see a record which has some associations.</li>
	<li>Next to has_many association a count of number of associated records is shown.</li>
	<li>All the associated records are links so you can navigate from record to record.</li>
</ul>
<h4 id="miscellaneousfeatures">2.4 Miscellaneous features</h4>
<ul>
	<li><tt>admin_data</tt> supports namespaced models like <tt>Vehicle::Car</tt> .</li>
	<li>Plugin does not assume that all the tables have primary key as <tt>id</tt>. It respects the primary_key set in the model.</li>
	<li><span class="caps">RSS</span> feed for all the models.</li>
</ul>
<h3 id="installing">3 Installing</h3>
<p>Installing the plugin is easy.</p>
<div class="code_container"><code class="ruby">
ruby script/plugin 
   install git://github.com/neerajdotname/admin_data.git
</code></div>
<p>After installing the plugin start your server and visit <tt>http://localhost:3000/admin_data</tt> .</p>
<h3 id="configuringtheplugin">4 Configuring the plugin</h3>
<p><tt>admin_data</tt> allows you to configure certain features. Create a file under <tt>config/initializers</tt> like this <tt>config/initializers/admin_data_settings.rb</tt> . This is the file were all the configure settings will be stored.</p>
<h4 id="numberofrecordsperpage">4.1 Number of records per page</h4>
<p>By default <tt>admin_data</tt> leaves it upto <tt>will_paginate</tt> to decided how many records should be shown in a page. You can control how many records should be shown on a page.</p>
<div class="code_container"><code class="ruby">
# ~/confing/initializers/admin_data_settings.rb
AdminData::Config.set = {
  :will_paginate_per_page =&gt; 50
}
</code></div>
<h4 id="localjqueryfileinsteadofgooglehostedversion">4.2 local jquery file instead of google hosted version</h4>
<p><tt>admin_data</tt> uses jQuery . Don&#8217;t worry using <tt>admin_data</tt> will have no impact on rest of your application if you are using some other JavaScript library. By default <tt>admin_data</tt> uses google hosted version to load jQuery files. However if you do not have internet connection or if you don&#8217;t want to use google version then you can use the local jQuery files supplied with the plugin.</p>
<div class="code_container"><code class="ruby">
AdminData::Config.set = {
  :use_google_hosting_for_jquery =&gt; false
}
</code></div>
<h4 id="ignorecolumnlimit">4.3 Ignore column limit</h4>
<p><a href="http://www.igvita.com/">Ilya</a> brought to my attention this <a href="https://rails.lighthouseapp.com/projects/8994/tickets/876">rails ticket</a> . If the input field for a column is shorter than it should be then most likely you have run into this problem. One way to get around to this problem is to configure admin_data to not to use column.limit . In this way all text fields will have width of 60 . You can configure like this</p>
<div class="code_container"><code class="ruby">
AdminData::Config.set = {
  :ignore_column_limit =&gt; true
}
</code></div>
<h4 id="overridethedefaultfindcondition">4.4 Override the default find condition</h4>
<p>I have a model called <tt>City</tt> which is defined like this.</p>
<div class="code_container"><code class="ruby">
class City &lt; ActiveRecord::Base
  def to_param
    self.permanent_name
  end
end
</code></div>
<p>For <tt>show</tt> action <tt>admin_data</tt> will generate url which could look like <tt>/admin_data/city/miami</tt> . The controller will execute the query assuming that id is <tt>miami</tt> and the record will <span class="caps">NOT</span> be found.</p>
<p>Here is how that can be fixed.</p>
<div class="code_container"><code class="ruby">
AdminData::Config.set = {
 :find_conditions =&gt; 
         {'City' =&gt; lambda {|params| {:conditions =&gt; 
                                        [&quot;permanent_name = ?&quot;, params[:id]]}}}  
}
</code></div>
<h4 id="overridethedefaultbehaviourofcolumn">4.5 Override the default behaviour of column</h4>
<p>I have a <tt>Car</tt> model.</p>
<div class="code_container"><code class="ruby">
class Car &lt; ActiveRecord::Base
  serialize :data
end
</code></div>
<p>I am going to create a record and set value to data.</p>
<div class="code_container"><code class="ruby">
Car.create(:data =&gt; { :color =&gt; ‘black’, :year =&gt; ‘2000’})
</code></div>
<p>If you look at this record using admin_data then for the column ‘data’ will have following value:</p>
<div class="code_container"><code class="ruby">
colorblackyear2000
</code></div>
<p>This is not very useful. If I could ask plugin to perform <tt>to_inspect</tt> on hash then output will be much more easy to read. Given below is how I can ask plugin to perform inspect method on data column.</p>
<div class="code_container"><code class="ruby">
AdminData::Config.set = ({
  :column_settings =&gt; { 'Car' =&gt; { :data =&gt; lambda{|model| model.send(:data).inspect}}}
})
</code></div>
<p><tt>admin_data</tt>  passes the model instanct to proc and the user can customize the value for that model as per his/her taste.</p>
<p>Based on this setting the new output would be much more readable.</p>
<h4 id="replacedropdownassociationswithinputtext">4.6 Replace drop down associations with input text</h4>
<p>Let&#8217;s say that I have two tables: users table and phone_numbers. If I edit a phone number then I would be presented with the drop down of all the user ids. If I have 50K user records then page will be slow .</p>
<p>To get around this problem you can configure <tt>admin_data</tt> so that instead of <tt>select field</tt> you are given <tt>input text</tt>.</p>
<div class="code_container"><code class="ruby">
AdminData::Config.set = ({
 :drop_down_for_associations =&gt; false
})
</code></div>
<h4 id="rs-sfeedforallmodels">4.7 <span class="caps">RSS</span> feed for all models</h4>
<p><tt>admin_data</tt> provides <span class="caps">RSS</span> feed for all models. <span class="caps">RSS</span> feed can only be consumed if you are properly authenticated. <tt>admin_data</tt> uses http basic authentication mechanism to authenticate requests for <span class="caps">RSS</span> feed. Given below is how you can provider userid and password against to check for authentcation.</p>
<div class="code_container"><code class="ruby">
AdminData::Config.set = {
  :feed_authentication_user_id =&gt; 'admin_data',
  :feed_authentication_password =&gt; 'welcome'
end
</code></div>
<p>The url to access <span class="caps">RSS</span> feed for model <tt>user</tt> would be <tt>http://localhost:3000/admin_data/feed/user</tt> . In this link substitute <tt>user</tt> with the model you want to track.</p>
<h4 id="customorderofcolumnsinlisting">4.8 Custom order of columns in listing</h4>
<p>I have an Article model which ,by default, lists columns in following order: id, body, title, author_name, published_at .</p>
<p>If I want order of columns to be changed then I need configure that.</p>
<div class="code_container"><code class="ruby">
AdminData::Config.set = {
  :columns_order =&gt; {'Article' =&gt; [:id, :title, :body, :published_at, :author_name]}  
}
</code></div>
<h3 id="security-configurations">5 Security Configurations</h3>
<p>Default security configuration is to allow both view and update access in development mode and restrict both view and update access in any other environment. The default security configuration looks like this</p>
<div class="code_container"><code class="ruby">
AdminData::Config.set = {
  :is_allowed_to_view =&gt; lambda {|controller| return true if Rails.env.development? },
  :is_allowed_to_update =&gt; lambda {|controller| return true if Rails.env.development? },
}
</code></div>
<p>This is how I configure security settings for non development environments.</p>
<div class="code_container"><code class="ruby">
AdminData::Config.set = {
  :is_allowed_to_view =&gt; lambda {|controller| controller.send('logged_in?') },
  :is_allowed_to_update =&gt; lambda {|controller| controller.send('admin_logged_in?') },
}
</code></div>
<p>In the above case application_controller.rb must have method <tt>logged_in?</tt> and <tt>admin_logged_in?</tt> .</p>
<p>As you can see <tt>controller</tt> is provided as argument to proc so you can invoke any method on controller to decide if the user should have access or not.</p>
<p>You can also define security at a model level. Just use @model in the proc and model instance would be made available as @model .</p>
<pre>
AdminData::Config.set = {
  :is_allowed_to_view_model =&gt; lambda {|controller| controller.send('logged_in?')  &amp;&amp; @model.author_name == 'john' },
  :is_allowed_to_update =&gt; lambda {|controller| controller.send('admin_logged_in?') &amp;&amp; @model.author_name == 'john' },
}
</pre>
<h3 id="howtousethispluginwithrails3">6 How to use this plugin with rails3</h3>
<p>This plugin works with rails3. This plugin has been converted into a gem for usage in <tt>rails 3</tt>.</p>
<p>Since this plugin depends on <tt>will_paginate</tt> gem, first you need to install a version of <tt>will_paginate</tt> that works with rails 3. That can be done by adding following line to <tt>Gemfile</tt> .</p>
<div class="code_container"><code class="ruby">
gem 'will_paginate', :git =&gt; 'git://github.com/mislav/will_paginate.git', :branch =&gt; 'rails3'
</code></div>
<p>You can install the gem using bundler like this.</p>
<div class="code_container"><code class="ruby">
gem 'admin_data'
</code></div>
<h3 id="howtoruntestforthisplugin">7 How to run test for this plugin</h3>
<p>This plugin has over 200 tests. To run those tests just go to the root of the plugin directory and type <tt>rake</tt> .</p>
<h3 id="authorand-contributors">8 Author and Contributors</h3>
<p>This plugin is written by <a href="http://github.com/neerajdotname">Neeraj Singh</a> . I am on twitter as <a href="http://twitter.com/neerajdotname">neerajdotname</a>. I am grateful to <a href="http://github.com/neerajdotname/admin_data/contributors">other authors</a> who have contributed to this plugin.</p>
      </div>
    </div>
  </div>

  <hr class="hide" />
</body>
</html>
      <script type="text/javascript">
      	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      	document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
      </script>
      <script type="text/javascript">
      	var pageTracker = _gat._getTracker("");
      	pageTracker._initData();
      	pageTracker._trackPageview();
      </script>      
